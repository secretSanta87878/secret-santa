<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Secret Santa</title>
  <style>
    :root { color-scheme: light; }
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      background:#f6f7fb;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:#0f172a;
    }
    .wrap { width: 100%; display:grid; place-items:center; padding: 22px 0; }
    .card{
      width:min(720px,calc(100% - 32px));
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:18px;
      box-shadow:0 12px 34px rgba(15,23,42,.10);
      padding:22px;
    }
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
      flex-wrap:wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fbfbff;
      font-size:13px;
      color:#334155;
      white-space:nowrap;
    }
    h1{ font-size:20px; margin:10px 0 6px; }
    p{ margin:8px 0; color:#334155; line-height:1.55; }
    .small{ font-size:12px; color:#64748b; }

    .bar{
      height:10px;
      background:#e2e8f0;
      border-radius:999px;
      overflow:hidden;
      margin:14px 0 8px;
    }
    .bar > div{
      height:100%;
      width:0%;
      background:#0f172a;
      border-radius:999px;
      transition:width .35s ease;
    }

    .btnrow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:14px; }
    button{
      border:0;
      border-radius:12px;
      padding:12px 14px;
      font-weight:650;
      cursor:pointer;
    }
    .primary{ background:#0f172a; color:#fff; }
    .ghost{ background:#e2e8f0; color:#0f172a; }
    .danger{ background:#991b1b; color:#fff; }

    .reveal{
      margin-top:14px;
      padding:14px;
      border-radius:14px;
      border:1px dashed #cbd5e1;
      background:#f8fafc;
    }
    .hidden{ display:none; }

    .msg{
      white-space:pre-wrap;
      font-size:15px;
      color:#0f172a;
    }

    .formRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    input, select{
      flex: 1 1 220px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px 12px;
      font-size: 14px;
      outline: none;
      background:#fff;
    }
    input:focus, select:focus{ border-color:#94a3b8; }

    .ok{ color:#166534; }
    .warn{ color:#92400e; }
    .muted{ opacity:.85; }
    .hr { height:1px; background:#e5e7eb; margin:14px 0; }

    .badgeLine{
      margin-top:10px;
      font-size:13px;
      color:#0f172a;
    }
    .badgePill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fff;
      font-size:13px;
      color:#0f172a;
    }
    .noteBox{
      margin-top:12px;
      padding:12px;
      border-radius:14px;
      border:1px solid #e5e7eb;
      background:#fff;
    }

    .videoText{
      font-size:18px;
      line-height:1.6;
      color:#0f172a;
      margin-top:14px;
    }
    @media (max-width:480px){
      .videoText{ font-size:16px; }
    }

    /* Role board */
    .roleBoard{
      margin-top:14px;
      padding:14px;
      border-radius:14px;
      border:1px solid #e5e7eb;
      background:#fff;
    }
    .roleBoard h2{
      margin:0 0 6px;
      font-size:16px;
      color:#0f172a;
    }
    .roleTable{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid #e5e7eb;
      border-radius:12px;
      margin-top:10px;
    }
    .roleTable th, .roleTable td{
      padding:10px 12px;
      border-bottom:1px solid #e5e7eb;
      font-size:14px;
      vertical-align:top;
    }
    .roleTable th{
      background:#f8fafc;
      color:#334155;
      text-align:left;
      font-weight:650;
    }
    .roleTable tr:last-child td{ border-bottom:0; }
    .rtl{
      direction: rtl;
      text-align: right;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    }
    .miniPill{
      display:inline-flex;
      align-items:center;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fbfbff;
      font-size:12px;
      color:#334155;
      margin-left:8px;
    }

    /* Countdown ceremony */
    .countdownBox{
      margin-top:14px;
      padding:16px;
      border-radius:14px;
      border:1px solid #e5e7eb;
      background:#0f172a;
      color:#fff;
    }
    .countdownTitle{
      margin:0 0 6px;
      font-size:14px;
      opacity:.9;
    }
    .countdownNumber{
      font-size:46px;
      font-weight:800;
      letter-spacing:1px;
      line-height:1.1;
    }
    .countdownHint{
      margin-top:8px;
      font-size:12px;
      opacity:.85;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="pill">ğŸ Secret Santa â€¢ Group Surprise</div>
        <div class="pill" id="whoPill">Not checked in</div>
      </div>

      <h1 id="title">Welcome guys to the "no name" game</h1>
      <p id="subtitle">
        It is a simple and a short game (5â€“7 mins). First, pick your name, then press READY.
        One of us will be the host; the host will reveal a code.
        After all of you click READY, try to do all other steps at the same time.
      </p>

      <!-- CHECK-IN BOX -->
      <div class="reveal" id="checkinBox">
        <p class="small muted">You will be assigned 2 roles: one English badge + one Arabic role.</p>

        <div class="formRow">
          <select id="nameSelect">
            <option value="" selected disabled>Select your name</option>
            <option>Ahmad</option>
            <option>Alan</option>
            <option>Aous</option>
            <option>Bashar</option>
            <option>Nisreen</option>
            <option>Roaa</option>
            <option>Sidra</option>
            <option>Taima</option>
            <option>Tharaa</option>
            <option>Yara</option>
            <option>Yazan</option>
            <option value="__other__">Other (type manually)</option>
          </select>

          <button class="primary" id="readyBtn">READY</button>
        </div>

        <!-- Manual name row (only if Other) -->
        <div class="formRow hidden" id="otherNameRow">
          <input id="nameInput" placeholder="Don't type anything here" autocomplete="name" />
          <button class="ghost" id="useSelectedBtn" type="button">Don't click please</button>
        </div>

        <!-- Fun: verification line + badge -->
        <div class="noteBox hidden" id="funBox">
          <div class="small muted" id="verifyLine">Verificationâ€¦</div>
          <div class="badgeLine" id="badgeLine"></div>
          <div class="small muted" style="margin-top:8px;">
            Please read the line above, then keep your phone on this screen.
          </div>
        </div>

        <div class="small" id="checkinStatus" style="margin-top:10px;">
          Status: <span class="warn">Not ready</span>
        </div>

        <div class="hr"></div>

        <!-- Non-host waiting box -->
        <div id="waitingBox" class="hidden">
          <p><strong>Waiting for the hostâ€¦</strong></p>

          <div class="noteBox">
            <p class="small" style="margin:0;">
              Before pressing START: everyone should be ready on this page, and say out loud which role is assigned to you, (it is okay if there are repeated roles).
              When the host says the code, type it below, then all of you (including the host) press START at the SAME TIME and DON't REFRESH THE PAGE.
            </p>
          </div>

          <div class="formRow">
            <input id="codeInput" placeholder="Start code (host will say it)" autocomplete="off" />
            <button class="primary" id="joinBtn">START</button>
          </div>
          <div class="small" id="codeHint" style="margin-top:8px;"></div>
        </div>

        <!-- Host control box -->
        <div id="hostBox" class="hidden">
          <p><strong>Host mode (Roaa)</strong></p>

          <div class="noteBox">
            <p class="small" style="margin:0;">
              The code is: <strong>2026</strong>. Say it out loud, let them type the code,
              then all together press START.
            </p>
          </div>

          <div class="btnrow">
            <button class="danger" id="hostStartBtn">START</button>
          </div>
          <div class="small" id="hostHint" style="margin-top:8px;"></div>
        </div>
      </div>

      <!-- FLOW BOX -->
      <div id="flowBox" class="hidden">
        <div class="bar"><div id="fill"></div></div>
        <div class="small" id="status">Initializingâ€¦</div>

        <!-- Ceremony countdown -->
        <div class="countdownBox hidden" id="countdownBox">
          <div class="countdownTitle">Role assignment ceremony</div>
          <div class="countdownNumber" id="countdownNumber">3</div>
          <div class="countdownHint">Everyone look at your screen. Do not blink.</div>
        </div>

        <!-- Role assignment board -->
        <div class="roleBoard hidden" id="roleBoard">
          <h2>
            Official Role Assignment
            <span class="miniPill">based on code</span>
          </h2>
          <p class="small" style="margin:6px 0 0;">
            The system has assigned one role to each person. Please accept your fate.
          </p>

          <table class="roleTable">
            <thead>
              <tr>
                <th style="width:40%;">Name</th>
                <th>Role</th>
              </tr>
            </thead>
            <tbody id="roleTbody"></tbody>
          </table>

          <p class="small" style="margin-top:10px;">
            After everyone reads their role, continue below.
          </p>
        </div>

        <!-- Joke -->
        <div class="reveal hidden" id="jokeBox">
          <p><strong>Result:</strong> Your roles will be used in the next step of the game.</p>
          <p class="small">Just kidding. There is no game. Itâ€™s just a message for all of you. Click the button below :)</p>

          <div class="btnrow" style="margin-top:12px;">
            <button class="primary" id="revealMsgBtn">Click to reveal the real message</button>
          </div>
        </div>

        <!-- Real message -->
        <div class="reveal hidden" id="msgBox">
          <p><strong>Okay, real message:</strong></p>
          <div class="msg" id="msg"></div>
          <p class="small" id="footerSmall"></p>

          <p class="small" style="margin-top:12px;">
            P.S. There is something else below â€” scroll down a bit.
          </p>
        </div>
      </div>
    </div>

    <!-- Big scroll gap -->
    <div id="scrollGap" class="hidden" style="height:2400px;"></div>

    <!-- Video far down -->
    <div class="card hidden" id="videoSection">
      <div class="pill">ğŸ¬ Bonus</div>
      <h1 style="margin-top:10px;">One more thingâ€¦</h1>

      <video controls preload="metadata" style="width:100%; border-radius:14px; margin-top:12px;">
        <source src="video.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>

      <p class="videoText">
        Okay, no more jokes. Thank you all. Now Roaa can open her gift ğŸ«°ğŸ»ğŸ«°ğŸ»ğŸ«°ğŸ».
      </p>
    </div>
  </div>

  <script>
    // =========================
    // CONFIG
    // =========================
    const NAMES = [
      "Ahmad","Alan","Aous","Bashar","Nisreen","Roaa","Sidra","Taima","Tharaa","Yara","Yazan"
    ]; // fixed list for the role table

    const HOST_NAMES = ["Roaa", "roaa", "roa", "roa'a", "roaa ", "Ø±Ø¤Ù‰", "Ø±ÙˆØ§Ø¡", "Ø±Ø¤ÙŠØ§"]
      .map(s => s.trim().toLowerCase());

    const START_CODE = "2026";

    const MESSAGE_LINES = [
      "Merry Christmas and happy new year guys â¤ï¸â¤ï¸â¤ï¸",
      "I just wanted to say Iâ€™m really happy youâ€™re in my life.",
      "But yes, there is one more thing."
    ];
    const FOOTER = "Signed: Roaa's secret santa";

    const VERIFY_LINES = [
      "Identity verified. You look trustworthy today.",
      "Verification complete. Please act normal.",
      "Name accepted. Your vibe has been approved.",
      "Security check passed. No suspicious holiday behavior detected.",
      "Confirmed. You are officially part of the ceremony.",
      "Accepted. Do not refresh. This is your only warning."
    ];

    const BADGES = [
      "Chief Holiday Officer",
      "Minister of Snacks",
      "Head of Dramatic Reactions",
      "Director of Good Vibes",
      "Certified QR Scanner",
      "Lead Laugh Producer",
      "Guardian of the Group Energy",
      "Senior Approval Authority"
    ];

    const ROLES_AR = [
  "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø¶Ø­Ùƒ",
  "ÙˆØ²ÙŠØ± Ø§Ù„Ø³Ù†Ø§ÙƒØ§Øª",
  "Ù…Ø¯ÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©",
  "Ø­Ø§Ø±Ø³ Ø§Ù„Ø³Ø±Ù‘",
  "Ù…Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù‚Ø¹Ø¯Ø©",
  "Ù‚Ø§Ø¦Ø¯ Ø§Ù„ØªØµÙÙŠÙ‚",
  "Ø®Ø¨ÙŠØ± Ø§Ù„ØªÙ…Ø«ÙŠÙ„ ÙˆØ§Ù„Ù…Ø¨Ø§Ù„ØºØ©",
  "Ù…Ø®Ø±Ø¬ Ø§Ù„Ù„Ø­Ø¸Ø©",
  "Ù…ÙØªÙ‘Ø´ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„Ø±Ø³Ù…ÙŠ",
  "Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªØµÙˆÙŠØ± ÙˆØ§Ù„Ø°ÙƒØ±ÙŠØ§Øª",
  "Ø±Ø¦ÙŠØ³ Ù„Ø¬Ù†Ø© â€œØ´Ùˆ Ø¹Ù… ÙŠØµÙŠØ±ØŸâ€"
];

    // =========================
    // DOM
    // =========================
    const whoPill = document.getElementById("whoPill");
    const title = document.getElementById("title");
    const subtitle = document.getElementById("subtitle");

    const nameSelect = document.getElementById("nameSelect");
    const otherNameRow = document.getElementById("otherNameRow");
    const nameInput = document.getElementById("nameInput");
    const useSelectedBtn = document.getElementById("useSelectedBtn");

    const readyBtn = document.getElementById("readyBtn");
    const checkinStatus = document.getElementById("checkinStatus");

    const funBox = document.getElementById("funBox");
    const verifyLine = document.getElementById("verifyLine");
    const badgeLine = document.getElementById("badgeLine");

    const waitingBox = document.getElementById("waitingBox");
    const codeInput = document.getElementById("codeInput");
    const joinBtn = document.getElementById("joinBtn");
    const codeHint = document.getElementById("codeHint");

    const hostBox = document.getElementById("hostBox");
    const hostStartBtn = document.getElementById("hostStartBtn");
    const hostHint = document.getElementById("hostHint");

    const checkinBox = document.getElementById("checkinBox");
    const flowBox = document.getElementById("flowBox");
    const fill = document.getElementById("fill");
    const status = document.getElementById("status");

    const countdownBox = document.getElementById("countdownBox");
    const countdownNumber = document.getElementById("countdownNumber");

    const roleBoard = document.getElementById("roleBoard");
    const roleTbody = document.getElementById("roleTbody");

    const jokeBox = document.getElementById("jokeBox");
    const msgBox = document.getElementById("msgBox");
    const revealMsgBtn = document.getElementById("revealMsgBtn");

    const scrollGap = document.getElementById("scrollGap");
    const videoSection = document.getElementById("videoSection");

    document.getElementById("msg").textContent = MESSAGE_LINES.join("\n");
    document.getElementById("footerSmall").textContent = FOOTER;

    // =========================
    // Helpers
    // =========================
    function normalizeName(s){
      return (s || "").trim().toLowerCase();
    }
    function isHostName(s){
      return HOST_NAMES.includes(normalizeName(s));
    }

    function hashString(str){
      let h = 0;
      for (let i = 0; i < str.length; i++){
        h = (h * 31 + str.charCodeAt(i)) >>> 0;
      }
      return h;
    }
    function pickBadgeForName(name){
      const h = hashString(normalizeName(name));
      return BADGES[h % BADGES.length];
    }
    function pickVerifyLine(){
      return VERIFY_LINES[Math.floor(Math.random() * VERIFY_LINES.length)];
    }

    function mulberry32(seed){
      return function(){
        let t = seed += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }
    function deterministicShuffle(arr, seedStr){
      const seed = hashString(String(seedStr));
      const rand = mulberry32(seed);
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--){
        const j = Math.floor(rand() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function buildRoleAssignments(){
      const names = NAMES.slice();
      const roles = ROLES_AR.slice();
      const shuffledRoles = deterministicShuffle(roles, START_CODE);
      return names.map((n, idx) => ({ name: n, role: shuffledRoles[idx] }));
    }
    function renderRoleBoard(){
      const pairs = buildRoleAssignments();
      roleTbody.innerHTML = "";
      for (const p of pairs){
        const tr = document.createElement("tr");
        const tdName = document.createElement("td");
        const tdRole = document.createElement("td");
        tdName.textContent = p.name;
        tdRole.textContent = p.role;
        tdRole.classList.add("rtl");
        tr.appendChild(tdName);
        tr.appendChild(tdRole);
        roleTbody.appendChild(tr);
      }
    }

    function setStatusReady(text){
      checkinStatus.innerHTML = `Status: <span class="ok">Ready</span> â€” ${text}`;
    }
    function setStatusNotReady(text){
      checkinStatus.innerHTML = `Status: <span class="warn">Not ready</span> â€” ${text}`;
    }

    function showHostUI(name){
      whoPill.textContent = `Host: ${name}`;
      waitingBox.classList.add("hidden");
      hostBox.classList.remove("hidden");
      hostHint.innerHTML = `When you press START, announce the code: <strong>${START_CODE}</strong>`;
    }
    function showGuestUI(name){
      whoPill.textContent = `Guest: ${name}`;
      hostBox.classList.add("hidden");
      waitingBox.classList.remove("hidden");
      codeHint.textContent = "";
    }

    function showFunLines(name){
      funBox.classList.remove("hidden");
      verifyLine.textContent = pickVerifyLine();
      const badge = pickBadgeForName(name);
      badgeLine.innerHTML = `Your role for today: <span class="badgePill">ğŸªª ${badge}</span>`;
    }

    function refreshNameMode(){
      const v = nameSelect.value;
      if (v === "__other__") {
        otherNameRow.classList.remove("hidden");
        nameInput.focus();
      } else {
        otherNameRow.classList.add("hidden");
      }
    }

    function getSelectedOrTypedName(){
      const v = nameSelect.value;
      if (v && v !== "__other__") return v.trim();
      if (v === "__other__") return (nameInput.value || "").trim();
      return "";
    }

    async function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

    // =========================
    // Flow
    // =========================
    let running = false;

    const steps = [
      { w: 25,  t: "Initializing game lobbyâ€¦", s: "Step 1/4: connecting all players and synchronizing devicesâ€¦", ms: 12000 },
      { w: 55,  t: "Verifying player readinessâ€¦", s: "Step 2/4: checking that all players are present and readyâ€¦", ms: 12000 },
      { w: 80,  t: "Preparing game stateâ€¦", s: "Step 3/4: loading shared experience and final settingsâ€¦", ms: 12000 },
      { w: 100, t: "Almost doneâ€¦", s: "Step 4/4: starting the game for all players simultaneouslyâ€¦", ms: 12000 }
    ];

    async function runCeremonyCountdown(){
      countdownBox.classList.remove("hidden");
      roleBoard.classList.add("hidden");

      const seq = ["ğŸ’ƒ","ğŸ•º","ğŸ’ƒğŸ’ƒ","ğŸ•ºğŸ•º","ğŸ’ƒğŸ’ƒğŸ’ƒ","ğŸ•ºğŸ•ºğŸ•º","5", "4","3", "2", "1", "0.75","0.50","0.25","0.1","0.05","0.005","0.0005","3.14","0.632","...","..",".","43503","43502","43501","tired?","ready?","ALLAH AKBAR", "REVEAL"];
      for (let i = 0; i < seq.length; i++){
        countdownNumber.textContent = seq[i];
        await sleep(i === seq.length - 1 ? 650 : 900);
      }
      countdownBox.classList.add("hidden");
    }

    async function runFlow(){
      if (running) return;
      running = true;

      checkinBox.classList.add("hidden");
      flowBox.classList.remove("hidden");

      fill.style.width = "0%";
      status.textContent = "Initializingâ€¦";

      countdownBox.classList.add("hidden");
      roleBoard.classList.add("hidden");
      jokeBox.classList.add("hidden");
      msgBox.classList.add("hidden");
      scrollGap.classList.add("hidden");
      videoSection.classList.add("hidden");

      title.textContent = "Please waitâ€¦";
      subtitle.textContent = "This may take a while, take a snack";

      for (let i=0;i<steps.length;i++){
        fill.style.width = steps[i].w + "%";
        title.textContent = steps[i].t;
        status.textContent = steps[i].s;
        await sleep(steps[i].ms);
      }

      await runCeremonyCountdown();
      renderRoleBoard();
      roleBoard.classList.remove("hidden");

      await sleep(1200);
      subtitle.textContent = "Okayâ€¦ you can stop taking this seriously now.";
      jokeBox.classList.remove("hidden");

      running = false;
    }

    // =========================
    // Events
    // =========================
    nameSelect.addEventListener("change", refreshNameMode);

    useSelectedBtn.addEventListener("click", () => {
      nameSelect.value = "";
      otherNameRow.classList.add("hidden");
      nameInput.value = "";
      nameSelect.focus();
    });

    readyBtn.addEventListener("click", () => {
      const rawName = getSelectedOrTypedName();

      if (!rawName) {
        setStatusNotReady("Please select your name (or choose Other and type it).");
        nameSelect.focus();
        return;
      }

      setStatusReady(`Welcome, ${rawName}.`);
      showFunLines(rawName);

      if (isHostName(rawName)) showHostUI(rawName);
      else showGuestUI(rawName);
    });

    hostStartBtn.addEventListener("click", () => {
      runFlow();
    });

    function tryJoin(){
      const typed = (codeInput.value || "").trim();
      if (typed !== START_CODE) {
        codeHint.innerHTML = '<span class="warn">Wrong code.</span> Wait for Roaa and try again.';
        codeInput.focus();
        codeInput.select();
        return;
      }
      codeHint.innerHTML = '<span class="ok">Correct.</span> Startingâ€¦';
      runFlow();
    }

    joinBtn.addEventListener("click", tryJoin);
    codeInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") tryJoin();
    });

    revealMsgBtn.addEventListener("click", () => {
      msgBox.classList.remove("hidden");
      scrollGap.classList.remove("hidden");
      videoSection.classList.remove("hidden");
      msgBox.scrollIntoView({ behavior: "smooth", block: "start" });
    });

    // Default state
    setStatusNotReady("Waiting.");
    refreshNameMode();
  </script>
</body>
</html>
